<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>FastAPI 회원가입 테스트</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        form { max-width: 500px; margin: 0 auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input[type="text"], input[type="password"] { width: 100%; padding: 10px; margin-top: 5px; margin-bottom: 15px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 14px 20px; margin-top: 10px; border: none; cursor: pointer; width: 100%; border-radius: 4px; }
        button:hover { background-color: #0056b3; }
        #response { margin-top: 25px; padding: 15px; border: 1px solid #000; white-space: pre-wrap; background-color: #fff; border-radius: 4px; }
        .success { border-color: green !important; color: green; }
        .error { border-color: red !important; color: red; }
    </style>
</head>
<body>
    <form id="registerForm">
        <h2>회원가입 정보 등록 (POST /api/register/info)</h2>
        <label for="company_name">회사명 (company_name):</label>
        <input type="text" id="company_name" name="company_name" required value="TEST_COMPANY">

        <label for="name">이름 (name):</label>
        <input type="text" id="name" name="name" required value="홍길동">

        <label for="user_id">사용자 ID (user_id):</label>
        <input type="text" id="user_id" name="user_id" required value="testuser123">

        <label for="department">부서 (department):</label>
        <input type="text" id="department" name="department" required value="개발부">

        <label for="preferred_language">선호 언어 (preferred_language):</label>
        <input type="text" id="preferred_language" name="preferred_language" required value="ko">
        
        <label for="pw">비밀번호 (pw):</label>
        <input type="password" id="pw" name="pw" required value="password123">
        
        <button type="submit">회원가입 요청 (POST)</button>
    </form>

    <div id="response">결과가 여기에 표시됩니다.</div>

    <script>
        document.getElementById('registerForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const responseDiv = document.getElementById('response');
            responseDiv.className = '';
            responseDiv.innerHTML = '요청 중...';

            // 1. 폼 데이터 수집
            const formData = new FormData(event.target);
            // Pydantic 모델에 맞게 name 필드를 제외한 모든 필드를 수집
            const data = Object.fromEntries(formData.entries());

            // 2. FastAPI 엔드포인트 설정 (라우터 prefix: /api 사용 가정)
            // 실제 엔드포인트 경로에 맞게 수정하세요.
            const url = 'http://localhost:8000/api/register/info'; 
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json', // JSON 형식으로 보냄
                    },
                    body: JSON.stringify(data), // 폼 데이터를 JSON 문자열로 변환
                });
                console.log(result)
                const result = await response.json();
                

                if (response.ok) {
                    responseDiv.className = 'success';
                    responseDiv.innerHTML = 
                        `✅ 회원가입 성공 (${response.status} ${response.statusText})\n\n` +
                        `응답: ${JSON.stringify(result, null, 2)}`;
                } else {
                    responseDiv.className = 'error';
                    responseDiv.innerHTML = `❌ 회원가입 실패: ${response.status} ${response.statusText}\n\n응답: ${JSON.stringify(result, null, 2)}`;
                }

            } catch (error) {
                responseDiv.className = 'error';
                responseDiv.innerHTML = `❌ 요청 실패 (네트워크 오류):\n${error}`;
            }
        });
    </script>
</body>
</html>