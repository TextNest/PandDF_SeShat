# 📝 PandDF_SeShat: 문서 기반 RAG Q&A 챗봇 프로젝트

이 프로젝트는 FastAPI를 기반으로 구축된 문서 기반 Q&A 챗봇 백엔드입니다. LangGraph를 활용한 에이전트 아키텍처를 통해 사용자의 질문에 대해 RAG(Retrieval-Augmented Generation) 기술로 답변합니다. 텍스트뿐만 아니라 향후 이미지 기반 질의응답까지 확장 가능하도록 설계되었습니다.

---

## ✨ MVP 개발 현황 (Minimum Viable Product)

### ✅ 완료된 기능
1.  **기본 RAG 챗봇**: LangGraph 에이전트 기반의 대화형 Q&A 기능.
2.  **실시간 소통**: WebSocket을 통한 실시간 양방향 통신 구현.
3.  **고급 검색 기법 적용**:
    -   **멀티벡터 검색**: 원본 문서의 작은 조각(Chunk)과 전체 문서를 함께 검색하여 정확도 향상.
    -   **멀티쿼리 생성**: 사용자 질문을 여러 관점의 질문으로 확장하여 검색 누락 방지.

### 🚧 미완료 및 개선 사항
1.  **이미지 데이터 처리**: 문서 내 이미지에 대한 질의응답 기능 개발.
2.  **데이터베이스 연동**: `Product_id`를 기반으로 DB에서 PDF 경로 및 Faiss 인덱스 위치를 조회하는 기능.
3.  **성능 최적화**: 대규모 서비스를 위한 응답 캐싱(Caching) 전략 구현.
4.  **보안 강화**: 프롬프트 인젝션 등 LLM 관련 보안 취약점 대응 방안 마련.

---

## 🚀 향후 개발 계획

### 기능 추가 예정
-   **에이전트 Tools 확장**:
    -   `FAQ Tool`: 자주 묻는 질문에 대한 빠른 답변 기능.
    -   `추천 Tool`: 사용자 질문 기반의 관련 제품 추천 기능.
    -   `스펙정보 Tool`: 정형화된 제품 스펙 정보 제공 기능.
-   **관리자 기능**:
    -   문서(PDF) 업로드 및 벡터화 실행 기능.
    -   Faiss 인덱스 및 데이터베이스 관리 페이지.

---

## 📂 프로젝트 구조
```
BackEnd/
│
├─── main.py                # FastAPI 애플리케이션의 메인 실행 파일
├─── requirements.txt       # 프로젝트에 필요한 Python 라이브러리 목록
├─── .env                   # API 키 등 민감한 환경 변수 설정 파일
├─── .gitignore             # Git 버전 관리에서 제외할 파일 및 폴더 목록 (.env,pycache,data,db)
│
├─── core/                  # 프로젝트의 핵심 설정 관리
│    └── config.py          # .env 파일 로드 등 환경 설정 관련 로직
│
├─── data/                  # 데이터 저장 폴더 (임시)
│    ├── docstore.pkl       # 원본 문서 조각(chunk) 저장소
│    ├── image_store.pkl    # 문서에서 추출한 이미지 데이터 저장소
│    └── faiss_index/       # 벡터 검색을 위한 FAISS 인덱스 파일 저장
│
├─── db/                    # 관계형 데이터베이스 관련 설정 
│    └── database.py        # SQLAlchemy 등 DB 연결 및 세션 관리
│
├─── module/                # 애플리케이션의 핵심 비즈니스 로직
│    ├── document_pr.py     # PDF 문서 파싱, 텍스트/이미지 추출 등 전처리 로직(관리자 서비스에 추가 예정)
│    ├── qa_service.py      # 텍스트 기반 RAG Q&A 체인 및 서비스 로직(현재 사용중)
│    ├── qa_service_img.py  # 이미지 기반 RAG Q&A 체인 및 서비스 로직(이미지도 추가로 보낼경우)
│    └── chat_agent.py      # LangGraph 기반의 대화형 에이전트 로직
│
├─── router/                # API 엔드포인트(URL 경로) 정의
│    └── chat.py            # 채팅 관련 API (WebSocket 연결 등) 라우터
│
├─── schemas/               # API 요청/응답 데이터 모델 정의 (Pydantic)
│    ├── document.py        # 문서 관련 데이터 스키마
│    └── qa.py              # Q&A 관련 데이터 스키마
│
└─── templates/             # 프론트엔드 HTML 템플릿 (임시 추후 프론트에서 연결)
     ├── main.html          # 메인 페이지
     └── chat.html          # 채팅 UI 페이지
```
---

## 📜 개발 규칙 (Convention)

### 1. 기본 원칙
-   **스타일**: 모든 Python 코드는 **PEP 8** 스타일 가이드를 준수합니다.
-   **네이밍**: 파일 및 폴더는 `snake_case`, 클래스는 `PascalCase`, 함수/변수는 `snake_case`를 사용합니다.
-   **의존성**: 모든 라이브러리는 `requirements.txt`에 명시합니다.

### 2. 디렉토리별 역할 (책임 분리 원칙)
-   **`main.py`**: FastAPI 앱 생성, 미들웨어 추가, 라우터 포함 등 **초기 설정만 담당**합니다. 비즈니스 로직을 포함하지 않습니다.
    - 현재 main을 통해 불러오지만 이후 api로만 사용 예정 -> 메인 페이지는 필터링만 사용 예정
-   **`router/`**: API 경로를 정의하고 요청/응답을 처리합니다. **요청 유효성 검사 후 `module/`의 서비스 함수를 호출**하는 역할만 수행합니다.
    - 현재 풀더는 router지만 react 연결 시 api로 풀더 변경 예정
-   **`module/`**: **모든 핵심 비즈니스 로직**이 위치합니다. 데이터베이스 처리, RAG 체인 실행 등 실질적인 작업을 수행합니다.
-   **`schemas/`**: API의 입출력 데이터 모델(Pydantic)만 정의합니다.
-   **`db/`**: 데이터베이스 연결, 세션 관리, 모델 정의를 담당합니다.
-   **`core/`**: `.env` 로드 등 프로젝트 전반의 설정을 담당합니다.